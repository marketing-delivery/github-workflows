name: 'Get API Domain'
description: 'Determines the API domain based on environment name'

inputs:
  env-name:
    description: 'Environment name (PROD, UAT, TEST, etc.)'
    required: true
  pr-number:
    description: 'Pull request number'
    required: true
  project-name:
    description: 'Project name'
    required: true
  

outputs:
  subdomain:
    description: 'The determined API domain'
    value: ${{ steps.set-domain.outputs.subdomain }}

runs:
  using: 'composite'
  steps:
    - id: set-domain
      shell: bash
      run: |
        if [ "${{ inputs.env-name }}" = "PROD" ]; then
          echo "subdomain=${{ inputs.project-name }}" >> $GITHUB_OUTPUT
        elif [ "${{ inputs.env-name }}" = "UAT" ]; then
          echo "subdomain=uat.${{ inputs.project-name }}" >> $GITHUB_OUTPUT
        elif [ "${{ inputs.env-name }}" = "TEST" ]; then
          echo "subdomain=test.${{ inputs.project-name }}" >> $GITHUB_OUTPUT
        else
          echo "subdomain=pr-${{ inputs.pr-number }}.${{ inputs.project-name }}" >> $GITHUB_OUTPUT
        fi 